{"version":3,"file":"index.js","sources":["../js/infiniteScroll.js","../js/themeToggle.js","../js/index.js","../js/menuOpen.js"],"sourcesContent":["/*\nThis script continously loads post as the user scrolls the page. It uses the IntersectionObserver API to detect when the last post is in view. When the last post is in view, it fetches the next page and appends the posts to the page. It then checks if there is a next page and if there is, it continues to observe the last post. If there is no next page, it disconnects the observer. \n\nImportantly, for this script to work, it requires that each card have the `post` class and that the card container have the `gh-postfeed` class\n*/\n\nlet link = document.querySelector('link[rel=\"next\"]')?.getAttribute('href');\n\n// Fetch and parse next page\nasync function getNextPage(url) {\n    try {\n        const res = await fetch(url);\n        \n        if (!res.ok) {\n            throw new Error('Failed to fetch page')\n        }\n        \n        const nextPageHtml = await res.text();\n        const parser = new DOMParser();\n        const parsed = parser.parseFromString(nextPageHtml, 'text/html');\n        const posts = parsed.querySelectorAll('.post');\n        const nextLink = parsed.querySelector('link[rel=\"next\"]')?.getAttribute('href');\n        \n        return {posts, nextLink}\n\n    } catch (error) {\n        throw new Error(error)\n    }\n}\n\nexport default function infiniteScroll() {\n    \n    if (!link) { return; }\n\n    const options = {\n        // When the last card is within a 150px of the viewport, fetch the next page. This provides a smoother transition between pages \n       rootMargin: '150px',\n    }\n\n    const callback = (entries, observer) => {\n        try {\n            entries.forEach(entry => {\n            \n                if (entry.isIntersecting) {\n                    \n                    if (link) {\n                        getNextPage(link).then(({posts, nextLink}) => {\n                            posts.forEach(post => {\n                                document.querySelector('.gh-postfeed').append(post)\n                            })\n\n                            if (nextLink) {\n                                link = nextLink;\n                                observer.observe(document.querySelector('.post:last-of-type'))\n                            } else {\n                                observer.disconnect()\n                            }\n                        })\n                    }\n                }\n            })\n        } catch (error) {\n            console.log(error)\n        }\n    }\n\n    let observer = new IntersectionObserver(callback, options);\n\n    observer.observe(document.querySelector('.post:last-of-type'))\n\n}","/**\n * Theme Toggle Module\n * Handles dark/light mode switching with localStorage persistence\n */\n\nconst THEME_KEY = \"internal-monologue-theme\";\nconst THEME_DARK = \"dark\";\nconst THEME_LIGHT = \"light\";\n\n/**\n * Get the current theme from localStorage or system preference\n * @returns {string} The current theme ('dark' or 'light')\n */\nfunction getTheme() {\n    // Check localStorage first\n    const storedTheme = localStorage.getItem(THEME_KEY);\n    if (storedTheme) {\n        return storedTheme;\n    }\n\n    // Fall back to system preference\n    if (window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches) {\n        return THEME_DARK;\n    }\n\n    return THEME_LIGHT;\n}\n\n/**\n * Set the theme on the document\n * @param {string} theme - The theme to set ('dark' or 'light')\n */\nfunction setTheme(theme) {\n    const root = document.documentElement;\n\n    if (theme === THEME_DARK) {\n        root.setAttribute(\"data-theme\", THEME_DARK);\n    } else {\n        root.setAttribute(\"data-theme\", THEME_LIGHT);\n    }\n\n    // Store preference\n    localStorage.setItem(THEME_KEY, theme);\n\n    // Dispatch custom event for other components\n    window.dispatchEvent(new CustomEvent(\"themechange\", { detail: { theme } }));\n}\n\n/**\n * Toggle between dark and light themes\n */\nfunction toggleTheme() {\n    const currentTheme = getTheme();\n    const newTheme = currentTheme === THEME_DARK ? THEME_LIGHT : THEME_DARK;\n    setTheme(newTheme);\n}\n\n/**\n * Initialize theme toggle functionality\n */\nfunction themeToggle() {\n    // Apply initial theme\n    const initialTheme = getTheme();\n    setTheme(initialTheme);\n\n    // Find all theme toggle buttons\n    const toggleButtons = document.querySelectorAll(\".gh-theme-toggle\");\n\n    toggleButtons.forEach((button) => {\n        // Remove any existing listeners to prevent duplicates\n        button.removeEventListener(\"click\", handleToggle);\n        // Add click listener\n        button.addEventListener(\"click\", handleToggle);\n    });\n\n    // Listen for system preference changes\n    if (window.matchMedia) {\n        const mediaQuery = window.matchMedia(\"(prefers-color-scheme: dark)\");\n        mediaQuery.addEventListener(\"change\", (e) => {\n            // Only update if user hasn't set a preference\n            if (!localStorage.getItem(THEME_KEY)) {\n                setTheme(e.matches ? THEME_DARK : THEME_LIGHT);\n            }\n        });\n    }\n}\n\n/**\n * Handle toggle button click\n * @param {Event} e - Click event\n */\nfunction handleToggle(e) {\n    e.preventDefault();\n    toggleTheme();\n}\n\nexport default themeToggle;\nexport { getTheme, setTheme, toggleTheme };\n","// Internal Monologue Theme JavaScript\n// Minimalist zen editorial Ghost theme with dark/light mode toggle\n\n// Import CSS\nimport \"../css/index.css\";\n\n// Import JS modules\nimport menuOpen from \"./menuOpen\";\nimport infiniteScroll from \"./infiniteScroll\";\nimport themeToggle from \"./themeToggle\";\n\n// Initialize when DOM is ready\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    // Initialize mobile menu\n    menuOpen();\n\n    // Initialize infinite scroll\n    infiniteScroll();\n\n    // Initialize theme toggle\n    themeToggle();\n});\n","// Toggle the menu open and close when on mobile\nexport default function menuOpen() {\n    const burgerButton = document.querySelector('.gh-burger');\n    burgerButton.addEventListener('click', function () {\n        document.body.classList.toggle('gh-head-open');\n    });\n}"],"names":["link","document","querySelector","getAttribute","infiniteScroll","IntersectionObserver","callback","entries","observer","forEach","entry","isIntersecting","async","url","res","fetch","ok","Error","nextPageHtml","text","parsed","DOMParser","parseFromString","posts","querySelectorAll","nextLink","error","getNextPage","then","_ref","post","append","observe","disconnect","console","log","rootMargin","THEME_KEY","THEME_DARK","THEME_LIGHT","getTheme","storedTheme","localStorage","getItem","window","matchMedia","matches","setTheme","theme","root","documentElement","setAttribute","setItem","dispatchEvent","CustomEvent","detail","handleToggle","e","preventDefault","addEventListener","body","classList","toggle","button","removeEventListener"],"mappings":"yBAMA,IAAIA,EAAOC,SAASC,cAAc,qBAAqBC,aAAa,QAwBrD,SAASC,IAEpB,IAAKJ,EAAQ,OAkCE,IAAIK,sBA3BFC,CAACC,EAASC,KACvB,IACID,EAAQE,SAAQC,IAERA,EAAMC,gBAEFX,GApCxBY,eAA2BC,GACvB,IACI,MAAMC,QAAYC,MAAMF,GAExB,IAAKC,EAAIE,GACL,MAAM,IAAIC,MAAM,wBAGpB,MAAMC,QAAqBJ,EAAIK,OAEzBC,GADS,IAAIC,WACGC,gBAAgBJ,EAAc,aAC9CK,EAAQH,EAAOI,iBAAiB,SAChCC,EAAWL,EAAOlB,cAAc,qBAAqBC,aAAa,QAExE,MAAO,CAACoB,QAAOE,WAEnB,CAAE,MAAOC,GACL,MAAM,IAAIT,MAAMS,EACpB,CACJ,CAkBwBC,CAAY3B,GAAM4B,MAAKC,IAAuB,IAAtBN,MAACA,EAAKE,SAAEA,GAASI,EACrCN,EAAMd,SAAQqB,IACV7B,SAASC,cAAc,gBAAgB6B,OAAOD,EAAK,IAGnDL,GACAzB,EAAOyB,EACPjB,EAASwB,QAAQ/B,SAASC,cAAc,wBAExCM,EAASyB,YACb,GAGZ,GAER,CAAE,MAAOP,GACLQ,QAAQC,IAAIT,EAChB,IA7BY,CAEbU,WAAY,UAgCNJ,QAAQ/B,SAASC,cAAc,sBAE5C,CCjEA,MAAMmC,EAAY,2BACZC,EAAa,OACbC,EAAc,QAMpB,SAASC,IAEL,MAAMC,EAAcC,aAAaC,QAAQN,GACzC,OAAII,IAKAG,OAAOC,YAAcD,OAAOC,WAAW,gCAAgCC,QAChER,EAGJC,EACX,CAMA,SAASQ,EAASC,GACd,MAAMC,EAAOhD,SAASiD,gBAElBF,IAAUV,EACVW,EAAKE,aAAa,aAAcb,GAEhCW,EAAKE,aAAa,aAAcZ,GAIpCG,aAAaU,QAAQf,EAAWW,GAGhCJ,OAAOS,cAAc,IAAIC,YAAY,cAAe,CAAEC,OAAQ,CAAEP,WACpE,CA6CA,SAASQ,EAAaC,GAClBA,EAAEC,iBAtCFX,EAFqBP,MACaF,EAAaC,EAAcD,EAyCjE,CClFArC,SAAS0D,iBAAiB,oBAAoB,KCVrB1D,SAASC,cAAc,cAC/ByD,iBAAiB,SAAS,WACnC1D,SAAS2D,KAAKC,UAAUC,OAAO,eACnC,IDYA1D,ID8CA2C,EADqBP,KAICvC,SAASuB,iBAAiB,oBAElCf,SAASsD,IAEnBA,EAAOC,oBAAoB,QAASR,GAEpCO,EAAOJ,iBAAiB,QAASH,EAAa,IAI9CZ,OAAOC,YACYD,OAAOC,WAAW,gCAC1Bc,iBAAiB,UAAWF,IAE9Bf,aAAaC,QAAQN,IACtBU,EAASU,EAAEX,QAAUR,EAAaC,EACtC,GC9DK"}